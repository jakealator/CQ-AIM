% test_generateCentroids.m
% Created: 02-01-2017 by JDR in Newark
% Last Modified: 
%
% Tests that the program generateCentroids.m works correctly by checking
% the number of centroids and their values against a specific case. If
% allTestsBool==1 then multiple tests are running and we don't need to
% initialize any external parameters. 

if allTestsBool ~= 1
    % Add correct path to get meshes and files-to-test on path
    cd ../../
    addpath(genpath('modules'))
    addpath(genpath('demo'))
    cd modules/tests
    mesh = 'twoCircles';
    meshStruct = initialize_mesh(mesh,1); % Initialize mesh (always use p=1 in second argument)
    N=meshStruct.nt; % number of centroid points
end

% Generate centroids with generateCentroids.m
centroids = generateCentroids(meshStruct,N);

%---- Begin tests ----%
centroidPassedTests = 0; % Indicates number of passed tests. 

% Test that the number of centroids is correct
if (length(centroids) == N)
    sprintf('generateCentroids Test: number of centroids PASSED');
    centroidPassedTests = centroidPassedTests + 1;
else
    error('generateCentroids Test: number of centroids FAILED.');
end

% Test that a handful of centroids were computed correctly. 
rElements = randi(N,5,1);
for j=1:5
    cElement = rElements(j);
    cTris = meshStruct.tris(cElement,1:3);
    cNodes = meshStruct.nodes(cElement,:);
    cCentroidX = 1/3*(cNodes(cTris(1),1)+cNodes(cTris(2),1)+cNodes(cTris(3),1));
    cCentroidY = 1/3*(cNodes(cTris(1),2)+cNodes(cTris(2),2)+cNodes(cTris(3),2));
    if ~(cCentroidX==centroids(cElement,1) && cCentroidY==centroids(cElement,2));
        error(strjoin({'generateCentroids Text: centroid number '},int2str(cElement), 'computed incorr))

